select VENDTABLE.ACCOUNTNUM,VENDTABLE.PARTYID,VENDTABLE.DATAAREAID,VENDTABLE.ADDRESS as VendorAddress
,ADDRESS.ADDRTABLEID,ADDRESS.ADDRRECID,ADDRESS.TYPE,
ADDRESS.NAME,DirPartyAddressRelationship.ISPRIMARY,ADDRESS.ADDRESS,
ADDRESS.PHONE,ADDRESS.TELEFAX,ADDRESS.TELEX,ADDRESS.URL,ADDRESS.PHONELOCAL,ADDRESS.CELLULARPHONE,ADDRESS.EMAIL,ADDRESS.TAXGROUP,ADDRESS.PAGER,ADDRESS.SMS
,ADDRESS.STREET,ADDRESS.CITY,ADDRESS.STATE,ADDRESS.COUNTRYREGIONID,
ADDRESS.ZIPCODE,ADDRESS.COUNTY
from VENDTABLE 
inner join DIRPARTYVIEW on VENDTABLE.PARTYID = DIRPARTYVIEW.PARTYID
inner join DirPartyAddressRelationship on DIRPARTYVIEW.PARTYID = DirPartyAddressRelationship.PARTYID
inner join DIRPARTYADDRESSRELATIONSHI1066 on DirPartyAddressRelationship.RECID = 
DIRPARTYADDRESSRELATIONSHI1066.PARTYADDRESSRELATIONSHIPRECID 
inner join ADDRESS on DIRPARTYADDRESSRELATIONSHI1066.REFCOMPANYID = ADDRESS.DATAAREAID
and DIRPARTYADDRESSRELATIONSHI1066.ADDRESSRECID = ADDRESS.RECID
--and DIRPARTYADDRESSRELATIONSHI1066.REFCOMPANYID = VENDTABLE.DATAAREAID
where ADDRESS.ADDRRECID != 0
 and VENDTABLE.DATAAREAID = 'leg'
and DIRPARTYVIEW.DATAAREAID = 'leg'
and DIRPARTYADDRESSRELATIONSHI1066.REFCOMPANYID = 'leg' 
--and ADDRESS.TYPE = 3
and ADDRESS.STREET != ''
--and ADDRESS.ADDRESS != VENDTABLE.ADDRESS
and VENDTABLE.ACCOUNTNUM = '10'
order by VENDTABLE.ACCOUNTNUM 